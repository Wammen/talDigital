@page "/{informationboardID:int}/{categoryID:int}"

@using VisitorApplication.Shared
@inject HttpClient Http

<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn-uicons.flaticon.com/uicons-regular-rounded/css/uicons-regular-rounded.css">
</head>

@if (postList == null)
{
    <p><em>Loading...</em></p>
}
else
{
    @foreach (var category in categoryList)
    {
        if (categoryID == category.CategoryId)
        {
            <!-- Category Title -->
            <section class="text-white">
                <div class="wrapper container mt-1">
                    <a class="col-1 btn float-start" href="@($"/{category.InformationBoardId}")"><i class="bi bi-arrow-left-square" style="font-size: 8vw; color: white;"></i></a>
                    <h1 class="col-10 text-center display-1 ms-0">@category.Title</h1>
                    <div class="col-1"></div>
                </div>
            </section>
        }
    }
}

<section class="row col-12 mx-auto">
    @if (postList == null)
    {
        <p><em>Loading...</em></p>
    }
    else
    {
        @foreach (var post in postList.OrderByDescending(x => x.PostID))
        {
            if (categoryID == post.CategoryID && post.IsPublished == true)
            {
                <a class="card mt-2 p-1 text-white text-decoration-none bg-white bg-opacity-25" type="submit" href="@($"/{informationboardID}/{categoryID}/{post.PostID}")">
                    <div class="card-body">
                        <h1 class="card-title">@post.Title</h1>
                        <p class="card-text">@post.Text</p>
                    </div>
                    <div class="card-footer ">@post.Author</div>
                </a>
            }
        }

    }
</section>


@code {
    Post[] postList;
    Category[] categoryList;

    protected async override Task OnInitializedAsync()
    {
        postList = await Http.GetFromJsonAsync<Post[]>("api/Post/PostList");
        categoryList = await Http.GetFromJsonAsync<Category[]>("api/Category/CategoryList");
    }

    [Parameter]
    public int informationboardID { get; set; }
    [Parameter]
    public int categoryID { get; set; }
    [Parameter]
    public int postID { get; set; }
}
