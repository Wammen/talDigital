@using ManagementPages.Functions
@using ManagementPages.UI.Components.Modals

<ManagementPages.UI.Components.Modals.NewPost @ref="NewPost"></ManagementPages.UI.Components.Modals.NewPost>
<ManagementPages.UI.Components.Modals.EditInfoboard @ref="EditInfoboard"></ManagementPages.UI.Components.Modals.EditInfoboard>
<ManagementPages.UI.Components.Modals.InfoboardStatistics @ref="InfoboardStatistics"></ManagementPages.UI.Components.Modals.InfoboardStatistics>
<ManagementPages.UI.Components.Modals.InfoboardQR @ref="InfoboardQR"></ManagementPages.UI.Components.Modals.InfoboardQR>

<section class="row col-12">
    <div class="col-3 border">
        <table class="table table-striped table-hover">
            <thead>
            <tr>
                <th scope="col">Informationstavler</th>
            </tr>
            </thead>
            <tbody>
                @foreach (var informationBoard in License.InformationBoards)
                {
                    <tr class="">
                        <td class="">
                            <button class="btn btn-outline p-0" @onclick="() => SetSelectedInformationBoard(informationBoard)">
                                @if (informationBoard == License.SelectedInformationBoard)
                                {
                                    @SetSelectedText(informationBoard)
                                }
                                else
                                {
                                    @informationBoard.InformationBoardModel.Title
                                }
                            </button>
                        </td>
                        <td>
                            <div class="float-end">
                                <button @onclick="() => EditInfoboard.Open()" class="btn ms-1 p-0">
                                    <i class="bi bi-pencil"></i>
                                </button>
                                <button @onclick="() => InfoboardQR.Open()" class="btn ms-1 p-0">
                                    <i class="bi bi-qr-code"></i>
                                </button>
                                <button @onclick="() => InfoboardStatistics.Open()" class="btn ms-1 p-0">
                                    <i class="bi bi-bar-chart"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>

        <table class="table table-striped table-hover">
            <thead>
            <tr>
                <th scope="col">
                    Redaktører
                </th>
                <th>
                    <button class="btn btn-primary me-0 float-end" disabled><i class="bi bi-plus-circle"></i> Tilføj ny redaktør</button>
                </th>
            </tr>
            </thead>
            <tbody>
            <tr class="">
                <td>Test Person</td>
                <td class="">
                    <button class="btn ms-1 p-0 float-end" disabled>
                        <i class="bi bi-trash"></i>
                    </button>
                    <button class="btn ms-1 p-0 float-end" disabled>
                        <i class="bi bi-pencil"></i>
                    </button>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- Dropdown menu -->
    <div class="col-9 border">
        <button @onclick="() => NewPost.Open()" class="btn btn-primary">
            <i class="bi bi-plus-circle"></i> 
            Nyt opslag
        </button>

        <div class="dropdown float-end">
            <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                Rediger rækkefølge på opslag
            </button>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                <li><a class="dropdown-item" href="#">Alfabetisk</a></li>
                <li><a class="dropdown-item" href="#">Ældste til nyeste</a></li>
                <li><a class="dropdown-item" href="#">Nyeste til ældste</a></li>
            </ul>
        </div>

        <PostOverview Category="@License.SelectedInformationBoard.SelectedCategory" />

    </div>
</section>

@code {
    [Parameter]
    public ILicenseViewModel License { get; set; }

    [Parameter]
    public EventCallback OnChangesMade { get; set; }

    private void SetSelectedInformationBoard(IInformationBoardViewModel selectedInformationBoard)
    {
        License.SelectedInformationBoard = selectedInformationBoard;
        OnChangesMade.InvokeAsync();
    }

    private string SetSelectedText(IInformationBoardViewModel informationBoard)
    {
        return $"{informationBoard.InformationBoardModel.Title} SELECTED";
    }

    private ManagementPages.UI.Components.Modals.NewPost NewPost { get; set; }
    private ManagementPages.UI.Components.Modals.EditInfoboard EditInfoboard { get; set; }
    private ManagementPages.UI.Components.Modals.InfoboardStatistics InfoboardStatistics { get; set; }
    private ManagementPages.UI.Components.Modals.InfoboardQR InfoboardQR { get; set; }
}